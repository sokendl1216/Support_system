# システム構成図（技術仕様）

## 1. システム全体構成

```
┌─────────────────────────────────────┐
│             Webブラウザ             │
│  (ユーザーがシステムにアクセスする画面)  │
└───────────────┬─────────────────────┘
                │
┌───────────────▼─────────────────────┐
│         Streamlit/Gradio UI         │
│     (ボタンや入力フォームを提供)      │
└───────────────┬─────────────────────┘
                │
┌───────────────▼─────────────────────┐
│         コアシステム制御部           │
├─────────────────────────────────────┤
│ ・画面遷移管理                       │
│ ・データの受け渡し                   │
│ ・セッション管理                     │
│ ・ユーザー入力の処理                 │
└───────┬───────────────────┬─────────┘
        │                   │
┌───────▼───────┐   ┌───────▼───────┐
│  AIエージェント  │   │   設定ファイル  │
├───────────────┤   ├───────────────┤
│ LangChain      │   │ ・仕事種類定義  │
│ DeepSeek Coder │   │ ・質問項目定義  │
│ Ollama         │   │ ・UI設定       │
│ Whisper/TTS    │   │ ・プロンプト設定 │
└───┬───────┬───┘   └───────────────┘
    │       │
┌───▼───┐ ┌─▼─────────┐
│ RAG DB │ │ 機能モジュール │
├───────┤ ├───────────┤
│ Chroma │ │ ・プログラム生成│
│ FAISS  │ │ ・HTML生成    │
│ 知識DB │ │ ・出力処理    │
└───────┘ └───────────┘
```

## 2. 技術スタックの詳細説明

### 2.1 フロントエンド（UI）
- **Streamlit** または **Gradio**
  - Pythonベースの簡単なWebUIフレームワーク
  - ボタン、入力フォーム、ファイルアップロード機能を提供
  - アクセシビリティ対応（色・サイズ調整）
  - レスポンシブデザイン対応

### 2.2 バックエンド（サーバー）
- **Python**：メインの開発言語
- **LangChain**：AIとの連携・対話管理
- **FastAPI**（オプション）：APIサーバーとして使用可能

### 2.3 AIモデル・機能
- **DeepSeek Coder / LLaMA / Mixtral**：コード生成用AI
- **Whisper**：音声入力処理
- **TTS（Text-to-Speech）**：読み上げ機能
- **Chroma / FAISS**：知識データベース（RAG）

### 2.4 データストレージ
- **JSON / YAML**：設定ファイル（仕事種類・質問項目など）
- **SQLite**（オプション）：ユーザー設定や履歴の保存
- **ローカルファイル**：生成物・アップロードファイルの保存

## 3. モジュール構成

### 3.1 コア機能モジュール
- **UI管理モジュール**：画面表示・データ受け渡し
- **セッション管理モジュール**：ユーザー状態管理
- **設定読み込みモジュール**：外部設定ファイル処理
- **AIエージェント連携モジュール**：LLMとの対話管理

### 3.2 業務モジュール
- **プログラム生成モジュール**：Pythonなどのコード自動生成
  - 画像分類サブモジュール
  - データ処理サブモジュール
  - その他プログラムサブモジュール
- **ホームページ生成モジュール**：HTML/CSS/JS自動生成
  - お店紹介ページサブモジュール
  - 個人ページサブモジュール
  - その他ホームページサブモジュール

### 3.3 ユーティリティモジュール
- **ファイル入出力モジュール**：アップロード・ダウンロード処理
- **プレビューモジュール**：生成物の表示機能
- **公開モジュール**：URLの生成・公開機能

## 4. データフロー

### 4.1 基本的なデータの流れ
1. ユーザーがUI（ボタン・フォーム）で入力
2. StreamlitがPythonバックエンドに入力を渡す
3. 設定ファイルから関連する質問・処理を呼び出す
4. AIエージェントがユーザー入力を解析・処理
5. 必要に応じてRAG DBから関連情報を取得
6. 機能モジュールが処理結果（コード・HTML）を生成
7. 結果をUIに表示・操作可能にする
8. 完成したら保存または公開処理

## 5. 拡張性・メンテナンス性への配慮

### 5.1 新しい仕事種類の追加方法
1. `job_types.json`に新しい仕事種類の定義を追加
2. 関連する質問を`questions.json`に追加
3. 必要なら専用のプロンプトを`prompts.json`に追加
4. 対応する処理モジュールを作成or既存モジュールを拡張

### 5.2 質問フローの変更方法
1. `questions.json`の質問内容・順序を編集
2. 必要ならUI表示を`ui_config.json`で調整
3. 変更をシステムに反映（再起動するだけ）

### 5.3 AIモデルの変更・追加方法
1. `models_config.json`に新しいモデル情報を追加
2. APIキーなどの設定を`.env`ファイルなどで管理
3. 必要なライブラリをインストール

## 6. デプロイ・実行環境

### 6.1 ローカル環境（開発・テスト用）
- Python 3.9+
- 必要なライブラリ（requirements.txtで管理）
- GPUがあれば望ましい（なくても動作可能）

### 6.2 本番環境
- クラウドサーバー（AWS, GCP, Azureなど）
- または専用サーバー・PC
- ファイアウォール・アクセス制限の設定
- バックアップ体制の確保

### 6.3 デプロイ方法
- Dockerコンテナ化
- または直接サーバーにインストール
- 環境変数で設定を切り替え

---

このシステム構成図をもとに、開発者が全体像を理解し、効率的に開発や保守ができるようにしています。
